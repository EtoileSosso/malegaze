<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: three/camera/Camera.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: three/camera/Camera.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import { CinematicCamera } from 'three/examples/jsm/cameras/CinematicCamera.js';
import { PerspectiveCamera, CameraHelper } from "three";
import cameraTypes from "./cameraTypes";


class Camera {
    camera;
    type;
    initialPosition = {x: 0, y: 0, z: 0}
    properties = {
        fov: 1,
        aspectRatio: window.innerWidth / window.innerHeight,
        near: 1,
        far: 1500
    }
    settings = {
        alphaOffset: 0,
        focusDistance: 0,
        focalLength: 24,
        fstop: 4,
        maxblur: 1,
        showFocus: false,
        focalDepth: 3,
        depthBlur: false,
    }
    helper = null

    /**
     *
     * @param {cameraTypes} type
     * @param {{fov, aspectRatio, near, far}} properties
     * @param {{x: Number, y: Number, z: Number}} initialPosition
     * @param {*} settings
     * @param {Boolean} debug
     */
    constructor({
        type,
        properties,
        initialPosition,
        settings,
        debug = false
    }) {
        // Build the camera depending of the type
        switch (type) {
            case cameraTypes.CINEMATIC :
                this.type = type
                this.camera = new CinematicCamera(
                    properties.fov ?? this.properties.fov,
                    properties.aspectRatio ?? this.properties.aspectRatio,
                    properties.near ?? this.properties.near,
                    properties.far ?? this.properties.far
                )
                break;
            case cameraTypes.PERSPECTIVE :
            default :
                this.type = cameraTypes.PERSPECTIVE
                this.camera = new PerspectiveCamera(
                    properties.fov ?? this.properties.fov,
                    properties.aspectRatio ?? this.properties.aspectRatio,
                    properties.near ?? this.properties.near,
                    properties.far ?? this.properties.far,
                )
        }

        // Set the camera position at initial position
        this.setCameraPosition(initialPosition ?? this.initialPosition)
        // Update the camera settings
        if(settings) this.updateCameraSettings(settings)
        // Build helper if debug enabled
        if(debug) this.buildHelper()

        if (this.type === cameraTypes.CINEMATIC) this.matChanger()
        this.update()
    }

    // -- GETTERS

    // ...

    // -- METHODS

    /**
     * Set the camera position
     * @param {Number} x
     * @param {Number} y
     * @param {Number} z
     */
    setCameraPosition({x, y, z}) {
        this.camera.position.x = x;
        this.camera.position.y = y;
        this.camera.position.z = z;
    }

    /**
     * Update the camera settings
     * @param settings
     */
    updateCameraSettings(settings){
        for(let [key, value] of Object.entries(settings)) {
            if(this.settings[key] !== null &amp;&amp; this.settings[key] !== undefined){
                this.settings[key] = value
            }
        }
    }

    /**
     * Build helper
     */
    buildHelper() {
        this.helper = new CameraHelper(this.camera);
    }

    /**
     * Mat changer
     */
    matChanger() {
        for ( let e in this.settings ) {
            if ( e in this.camera.postprocessing.bokeh_uniforms ) {
                this.camera.postprocessing.bokeh_uniforms[ e ].value = this.settings[e];
            }
        }

        this.camera.postprocessing.bokeh_uniforms[ 'znear' ].value = this.camera.near;
        this.camera.postprocessing.bokeh_uniforms[ 'zfar' ].value = this.camera.far;
        this.camera.setFocalLength( this.settings.focalLength);
        this.settings[ 'focalDepth' ] = this.camera.postprocessing.bokeh_uniforms[ 'focalDepth' ].value;
    }

    /**
     * Add elements to scene
     * @param scene
     */
    addToScene(scene){
        scene.add(this.camera)
        if(this.helper) scene.add(this.helper)
    }

    /**
     * Update loop
     */
    update() {
        // FIXME Update matChanger only if focalLength has changed
        this.camera.setFocalLength( this.settings.focalLength);
        if (this.type === cameraTypes.CINEMATIC){
            this.camera.focusAt( this.settings.focusDistance );
            // this.matChanger()
        }
    }
}

export default Camera
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Classes</h3><ul><li><a href="Camera.html">Camera</a></li><li><a href="CameraManager.html">CameraManager</a></li><li><a href="LightManager.html">LightManager</a></li><li><a href="MobileControls.html">MobileControls</a></li><li><a href="Model.html">Model</a></li><li><a href="ModelManager.html">ModelManager</a></li><li><a href="Scenery.html">Scenery</a></li><li><a href="SceneryManager.html">SceneryManager</a></li></ul><h3>Global</h3><ul><li><a href="global.html#ID">ID</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Wed Apr 29 2020 16:12:22 GMT+0200 (Central European Summer Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
